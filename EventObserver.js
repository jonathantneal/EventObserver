!function(a){function b(a,b,c){var d=this;d._CONNECTED=!1,d._ON=[],d._LISTENER=function(a){e(d,a)},d._TARGET=a,d._TYPE=b,d._USECAPTURE=c}function c(a,c,d){if(a instanceof b){if(c instanceof Function)return a;throw new TypeError(d+"() requires a valid callback.")}throw new TypeError("EventObserver requires a valid target.")}function d(a,b){a._ON.push(b)}function e(a,b){a._ON.forEach(function(c,d){c.call(a,b,d)})}function f(a){return!a._CONNECTED&&(a._CONNECTED=!0,a._TARGET instanceof b?f(a._TARGET):a._TARGET instanceof Node&&a._TYPE.trim().split(/\s+/).forEach(function(b){a._TARGET.addEventListener(b,a._LISTENER,a._CAPTURE)}),!0)}function g(a){a._CONNECTED&&(a._CONNECTED=!1,a._TARGET instanceof b?g(a._TARGET):a._TARGET instanceof Node&&a._TYPE.trim().split(/\s+/).reverse().forEach(function(b){a._TARGET.removeEventListener(b,a._LISTENER)}),a._ON.splice(0))}function h(a,c){return new b(this,a,c)}b.prototype={constructor:b,forEach:function(b){var e=c(this,b,"forEach");return f(e),d(e,b),e},filter:function(g){var h=c(this,g,"filter");f(h);var i=new b(h,h._TYPE,h._CAPTURE);return d(h,function(a,b){g.call(h,a,b)&&e(i,a)}),i},until:function(b){var e=c(this,b,"until");return f(e),d(e,function(a,c){b.call(e,a,c)&&g(e)}),e},map:function(g){var h=c(this,g,"map");f(h);var i=new b(h,h._TYPE,h._CAPTURE);return d(h,function(a,b){var c=g.call(h,a,b);e(i,c)}),i},start:function(){var b=c(this,c);return f(b),b},stop:function(){var b=c(this,c);return g(b),b}},a.EventObserver=b,a.Window.prototype.on=a.Document.prototype.on=a.Element.prototype.on=h}(this);